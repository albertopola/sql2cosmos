{
	"name": "T_Anagrafica_Flow",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureSql",
						"type": "DatasetReference"
					},
					"name": "source1"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "SqlJsonToBlobText",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT [value] FROM OPENJSON(\\n(SELECT modelname=\\'t_anagrafica\\',\\no.IdAnagrafica as sqlid,\\no.Denominazione as [name],\\no.CF as cf,\\no.PIVA as piva,\\no.Fornitore as fornitore,\\no.Cliente as cliente,\\no.Ente as ente,\\n\\n(select addressType=\\'Sede Legale\\', od.CAP as zip, od.Indirizzo as [address], od.Provincia as region, od.Citta as city from arc.T_Anagrafica  as od where od.IdAnagrafica=o.IdAnagrafica for json auto) as addressgroup,\\n(select contactType=\\'Ufficio\\', odd.TEL as phone, odd.FAX as fax, odd.email as email from arc.T_Anagrafica  as odd where odd.IdAnagrafica=o.IdAnagrafica for json auto) as contactgroup\\nFROM arc.T_AnagraFica as o FOR JSON PATH)\\n)',",
				"     format: 'query') ~> source1",
				"source1 sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     saveOrder: 1,",
				"     format: 'document') ~> sink1"
			]
		}
	}
}